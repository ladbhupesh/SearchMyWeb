<div class="search-container">
  <!-- Toast Notifications -->
  <div class="toast-container">
    <div 
      *ngFor="let toast of toasts" 
      class="toast"
      [ngClass]="'toast-' + toast.type"
      [@slideInOut]
    >
      <div class="toast-content">
        <div class="toast-icon">
          <span *ngIf="toast.type === 'success'">✅</span>
          <span *ngIf="toast.type === 'error'">❌</span>
          <span *ngIf="toast.type === 'warning'">⚠️</span>
          <span *ngIf="toast.type === 'info'">ℹ️</span>
        </div>
        <div class="toast-message">{{ toast.message }}</div>
        <button class="toast-close" (click)="removeToast(toast.id)">×</button>
      </div>
      <div class="toast-progress" [style.animation-duration]="toast.duration + 'ms'"></div>
    </div>
  </div>

  <!-- Search Input Section -->
  <div class="search-input-section">
    <div class="search-box">
      <div class="search-input-wrapper">
        <i class="search-icon">🔍</i>
        <input 
          type="text" 
          class="search-input" 
          placeholder="Search the web..." 
          #queryInput
          (keyup.enter)="search(queryInput)"
          (input)="onInputChange(queryInput)"
          [disabled]="isLoading"
        >
        <button 
          class="search-button" 
          (click)="search(queryInput)" 
          [disabled]="isLoading"
        >
          <span *ngIf="!isLoading">Search</span>
          <span *ngIf="isLoading" class="loading-spinner"></span>
        </button>
        <button 
          class="clear-button" 
          (click)="clearSearch(queryInput)"
          *ngIf="currentQuery"
          title="Clear search"
        >
          ✕
        </button>
      </div>
    </div>
    
    <!-- Search Stats -->
    <div class="search-stats" *ngIf="search_results_list.length > 0">
      <span class="result-count">{{search_results_list.length}} result{{search_results_list.length !== 1 ? 's' : ''}} found</span>
      <span class="search-time" *ngIf="searchTime">in {{searchTime}}ms</span>
    </div>
  </div>

  <!-- Results Section -->
  <div class="results-container">
    <!-- Loading State -->
    <div class="loading-state" *ngIf="resultStatus === 'loading'">
      <div class="loading-animation">
        <div class="search-icon-animated">🔍</div>
        <div class="loading-text">Searching...</div>
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="resultStatus === 'empty' && !isLoading">
      <div class="empty-icon">🔍</div>
      <h3>Start Your Search</h3>
      <p>Enter a search query above to find relevant results from your indexed content.</p>
      <div class="search-tips">
        <h4>Quick Tips:</h4>
        <ul>
          <li>Use specific keywords for better results</li>
          <li>Try different search terms</li>
          <li>Check your spelling</li>
        </ul>
      </div>
    </div>

    <!-- No Results State -->
    <div class="no-results-state" *ngIf="resultStatus === 'noresultfound'">
      <div class="no-results-icon">😔</div>
      <h3>No Results Found</h3>
      <p>We couldn't find any results for "{{currentQuery}}". Try different keywords or check your spelling.</p>
      <div class="search-suggestions">
        <h4>Search Tips:</h4>
        <ul>
          <li>Try different keywords</li>
          <li>Check your spelling</li>
          <li>Use more general terms</li>
          <li>Try synonyms</li>
        </ul>
        <button class="retry-button" (click)="retrySearch(queryInput)">
          🔄 Try Again
        </button>
      </div>
    </div>

    <!-- Results List -->
    <div class="results-list" *ngIf="search_results_list.length > 0">
      <div 
        class="result-item" 
        *ngFor="let result of search_results_list; let i = index"
        [attr.data-index]="i"
      >
        <div class="result-header">
          <a 
            [href]="result.link" 
            target="_blank" 
            class="result-title"
            [title]="result.title"
          >
            {{result.title || 'Untitled'}}
          </a>
          <div class="result-url">
            <i class="link-icon">🔗</i>
            <span class="url-text">{{formatUrl(result.link)}}</span>
          </div>
        </div>
        
        <div class="result-content">
          <p class="result-description">
            {{truncateText(result.description || 'No description available.', 200)}}
          </p>
        </div>
        
        <div class="result-actions">
          <a 
            [href]="result.link" 
            target="_blank" 
            class="visit-button"
          >
            <i class="external-icon">↗</i>
            Visit Page
          </a>
          <button 
            class="copy-button" 
            (click)="copyToClipboard(result.link)"
            [title]="'Copy link to clipboard'"
          >
            <i class="copy-icon">📋</i>
            Copy Link
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
